<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù„Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙÙŠØ¸</title>

    <!-- Ø®Ø· Ø¹Ø±Ø¨ÙŠ -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #0f766e;
            --primary-dark: #115e59;
            --accent: #f59e0b;
            --bg: #020617;
            --card-bg: #0b1120;
            --card-border: #1e293b;
            --text-main: #e5e7eb;
            --text-muted: #9ca3af;
            --danger: #dc2626;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: "Cairo", system-ui, sans-serif;
            background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            align-items: stretch;
            justify-content: center;
        }

        #app {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px 12px 32px;
        }

        /* ---------- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ---------- */

        .splash {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .splash::before {
            content: "";
            position: absolute;
            inset: -20%;
            background:
                radial-gradient(circle at top, rgba(56,189,248,0.10), transparent 60%),
                radial-gradient(circle at bottom, rgba(52,211,153,0.10), transparent 60%);
            opacity: 0.8;
            filter: blur(4px);
            animation: bgPulse 10s infinite alternate;
        }

        @keyframes bgPulse {
            0%   { transform: scale(1);   opacity: 0.9; }
            50%  { transform: scale(1.02); opacity: 1; }
            100% { transform: scale(1.05); opacity: 0.8; }
        }

        .splash-content {
            position: relative;
            z-index: 2;
            max-width: 540px;
            padding: 32px 24px;
            background: linear-gradient(to bottom right,
            rgba(15,23,42,0.95),
            rgba(15,23,42,0.9));
            border-radius: 24px;
            border: 1px solid rgba(148,163,184,0.35);
            box-shadow: 0 20px 45px rgba(15,23,42,0.9);
            animation: slideUp 1.2s ease-out;

            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        @keyframes slideUp {
            from {
                transform: translateY(40px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .logo-wrapper {
            position: relative;
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø§Ù„Ù…Ù†Ù‚Ù‘Ø· Ø§Ù„Ø°ÙŠ ÙŠØ¯ÙˆØ± Ø­ÙˆÙ„ Ø§Ù„Ø´Ø¹Ø§Ø± */
        .logo-orbit {
            position: absolute;
            width: 210px;
            height: 210px;
            border-radius: 28px;
            border: 2px dotted rgba(148,163,184,0.85);
            box-shadow: 0 0 18px rgba(15,23,42,0.9);
            pointer-events: none;
            animation: orbitRotate 16s linear infinite;
            transform-origin: center center;
        }

        @keyframes orbitRotate {
            from { transform: rotate(0deg); }
            to   { transform: rotate(360deg); }
        }

        .logo-wrapper img {
            position: relative;
            z-index: 2;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid rgba(248,250,252,0.95);
            box-shadow: 0 12px 30px rgba(15,23,42,0.9);
            background: #020617;
        }

        /* ÙƒØ§Ø±Øª Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­Øª Ø§Ù„Ø´Ø¹Ø§Ø± */
        .splash-badge {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            padding: 8px 18px;

            /* Ø¥Ù†Ø²Ø§Ù„ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø®Ø¶Ø± Ø£ÙƒØ«Ø± */
            margin-top: 40px;
            margin-bottom: 16px;

            border-radius: 999px;
            background: rgba(16,185,129,0.18);
            border: 1px solid rgba(16,185,129,0.6);
            color: #bbf7d0;
            font-size: 13px;
        }

        .splash-badge span:first-child {
            font-weight: 600;
        }

        .splash-title {
            font-size: 24px;
            font-weight: 700;
            margin: 12px 0 4px;
        }

        .center-subtitle {
            margin: 0 0 10px;
            font-size: 16px;
            font-weight: 500;
            color: #e5e7eb;
        }

        .splash-subtitle {
            font-size: 15px;
            color: var(--text-muted);
            margin-bottom: 22px;
        }

        .start-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 32px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, #22c55e, #10b981);
            color: #ecfeff;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 12px 30px rgba(16,185,129,0.65);
            transition: transform 0.14s ease, box-shadow 0.14s ease, filter 0.14s ease;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 18px 40px rgba(34,197,94,0.7);
            filter: brightness(1.05);
        }

        .start-btn:active {
            transform: translateY(1px) scale(0.99);
            box-shadow: 0 10px 24px rgba(16,185,129,0.6);
        }

        .start-btn-icon {
            font-size: 18px;
        }

        /* ---------- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ---------- */

        .hidden {
            display: none !important;
        }

        .main-layout {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */

        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 14px 18px;
            background: linear-gradient(to left,
            rgba(15,23,42,0.97),
            rgba(15,23,42,0.92));
            border-radius: 18px;
            border: 1px solid var(--card-border);
            box-shadow: 0 8px 22px rgba(15,23,42,0.8);
        }

        .app-header-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .app-logo-mini {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid rgba(248,250,252,0.9);
            background: #020617;
        }

        .app-header-text strong {
            display: block;
            font-size: 16px;
        }

        .app-header-text span {
            font-size: 12px;
            color: var(--text-muted);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .outline-btn {
            padding: 6px 10px;
            font-size: 12px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.6);
            background: transparent;
            color: var(--text-main);
            cursor: pointer;
        }

        .outline-btn:hover {
            border-color: rgba(248,250,252,0.9);
        }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… */

        .menu-card {
            background: rgba(15,23,42,0.96);
            border-radius: 18px;
            padding: 14px 16px;
            border: 1px solid var(--card-border);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .menu-section {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: space-between;
        }

        .menu-title {
            font-size: 14px;
            color: var(--text-muted);
        }

        .menu-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .menu-btn {
            border: none;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 999px;
            background: rgba(15,118,110,0.18);
            color: #a5f3fc;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: 1px solid transparent;
            transition: background 0.15s ease, transform 0.15s ease, border-color 0.15s ease;
        }

        .menu-btn .icon {
            font-size: 16px;
        }

        .menu-btn:hover {
            background: rgba(13,148,136,0.40);
            transform: translateY(-1px);
            border-color: rgba(45,212,191,0.6);
        }

        .menu-btn.active {
            background: linear-gradient(135deg, #0f766e, #14b8a6);
            color: #ecfeff;
            border-color: rgba(34,211,238,0.8);
        }

        /* Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„ */

        .table-section {
            background: rgba(15,23,42,0.96);
            border-radius: 18px;
            border: 1px solid var(--card-border);
            padding: 16px 16px 18px;
            box-shadow: 0 16px 40px rgba(15,23,42,0.85);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .table-header {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .table-header-title h2 {
            font-size: 18px;
            margin: 0;
        }

        .table-header-title span {
            font-size: 12px;
            color: var(--text-muted);
        }

        .table-header-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
        }

        .ghost-small {
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 12px;
            cursor: pointer;
            border: 1px solid rgba(148,163,184,0.6);
            background: transparent;
            color: var(--text-main);
        }

        .status-pill {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.6);
            color: var(--text-muted);
        }

        .status-pill.ok {
            border-color: rgba(74,222,128,0.7);
            color: #bbf7d0;
            background: rgba(22,163,74,0.15);
        }

        /* Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø¨Ø­Ø« */

        .search-input {
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.6);
            background: rgba(15,23,42,0.9);
            color: var(--text-main);
            font-size: 12px;
            min-width: 210px;
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        /* Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù†ÙØ³Ù‡ */

        .table-container {
            position: relative;
            border-radius: 14px;
            border: 1px solid rgba(30,64,175,0.6);
            overflow: hidden;
        }

        .table-scroll {
            max-height: calc(100vh - 260px);
            overflow: auto;
            scrollbar-width: thin;
            scrollbar-color: #334155 transparent;
        }

        .table-scroll::-webkit-scrollbar {
            height: 8px;
            width: 8px;
        }
        .table-scroll::-webkit-scrollbar-track {
            background: transparent;
        }
        .table-scroll::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 999px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 760px;
        }

        thead {
            background: linear-gradient(to left, #1e293b, #0f172a);
            position: sticky;
            top: 0;
            z-index: 5;
        }

        thead th {
            padding: 8px 6px;
            font-size: 13px;
            text-align: center;
            border-bottom: 1px solid rgba(51,65,85,0.9);
            white-space: nowrap;
        }

        tbody tr:nth-child(even) {
            background: rgba(15,23,42,0.95);
        }

        tbody tr:nth-child(odd) {
            background: rgba(15,23,42,0.90);
        }

        tbody td {
            padding: 6px 6px;
            font-size: 13px;
            border-bottom: 1px solid rgba(31,41,55,0.8);
            text-align: center;
            white-space: nowrap;
        }

        tbody tr:hover {
            background: rgba(30,64,175,0.35);
        }

        .loading-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom,
            rgba(15,23,42,0.96),
            rgba(15,23,42,0.96));
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 8px;
            z-index: 10;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border-radius: 999px;
            border: 3px solid rgba(148,163,184,0.4);
            border-top-color: #38bdf8;
            animation: spin 0.9s linear infinite;
        }

        .error-msg {
            color: var(--danger);
            font-size: 13px;
        }

        .muted-text {
            color: var(--text-muted);
            font-size: 12px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ---------- Responsiveness ---------- */

        @media (max-width: 1024px) {
            #app {
                padding: 16px 8px 24px;
            }

            .table-scroll {
                max-height: calc(100vh - 240px);
            }
        }

        @media (max-width: 768px) {
            .splash-content {
                margin: 0 12px;
                padding: 24px 18px;
            }

            .splash-title {
                font-size: 22px;
            }

            .splash-subtitle {
                font-size: 14px;
            }

            .app-header {
                flex-direction: column;
                align-items: flex-start;
                padding: 10px 12px;
            }

            .menu-card {
                padding: 10px 12px;
            }

            .table-section {
                padding: 12px;
            }

            .table-scroll {
                max-height: calc(100vh - 260px);
            }
        }

        @media (max-width: 480px) {
            .splash-title {
                font-size: 20px;
            }
            .splash-subtitle {
                font-size: 13px;
            }

            .menu-buttons {
                width: 100%;
            }

            .menu-btn {
                flex: 1 1 100%;
                justify-content: center;
            }

            table {
                min-width: 640px;
            }
        }
    </style>
</head>

<body>
<div id="app">

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <section id="splash" class="splash">
        <div class="splash-content">

            <div class="logo-wrapper">
                <div class="logo-orbit"></div>
                <img id="centerLogoBig" src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ÙƒØ²">
            </div>

            <div class="splash-badge">
                <span>Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù„Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙÙŠØ¸</span>
            </div>

            <h1 class="splash-title">
                Ù…Ø±ÙƒØ² Ø§Ù„Ù†Ø¹Ù…Ø§Ù† Ø¨Ù† Ù…Ù‚Ø±Ù‘ÙÙ†
            </h1>
            <p class="center-subtitle">
                Ù„ØªØ¹Ù„ÙŠÙ… ÙˆØªØ­ÙÙŠØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ§Ù„Ø³Ù†Ø©
            </p>

            <p class="splash-subtitle">
                Ø¨ÙˆØ§Ø¨Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ø­ÙØ¸ÙŠÙ† Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Google SheetsØŒ
                Ù„ØªØ³Ù‡ÙŠÙ„ Ø¹Ù…Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.
            </p>

            <button id="startBtn" class="start-btn">
                <span class="start-btn-icon">â–¶</span>
                <span>Ø§Ø¨Ø¯Ø£</span>
            </button>
        </div>
    </section>

    <!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <section id="main" class="hidden">
        <div class="main-layout">

            <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
            <header class="app-header">
                <div class="app-header-info">
                    <img id="centerLogoMini" class="app-logo-mini" src="logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ÙƒØ²">
                    <div class="app-header-text">
                        <strong>Ù„ÙˆØ­Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø±ÙƒØ² Ø§Ù„Ù†Ø¹Ù…Ø§Ù† Ø¨Ù† Ù…Ù‚Ø±Ù‘ÙÙ†</strong>
                        <span>Ø¹Ø±Ø¶ Ù…Ø¨Ø§Ø´Ø± Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ø­ÙØ¸ÙŠÙ† Ù…Ù† Google Sheets</span>
                    </div>
                </div>

                <div class="header-actions">
                    <button class="outline-btn" id="backToSplashBtn">
                        Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø§ÙØªØªØ§Ø­ÙŠØ©
                    </button>
                </div>
            </header>

            <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ (Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨) -->
            <div class="menu-card">
                <div class="menu-section">
                    <div class="menu-title">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                    <div class="menu-buttons">
                        <button class="menu-btn active" id="studentsMainBtn">
                            <span class="icon">ğŸ‘¨â€ğŸ“</span>
                            <span>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ø­ÙØ¸ÙŠÙ†</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø­Ù„ -->
            <div class="menu-card">
                <div class="menu-title">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø£Ùˆ Ù‚Ø³Ù… Ø§Ù„Ù…Ø­ÙØ¸ÙŠÙ† Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡</div>
                <div class="menu-buttons">
                    <button class="menu-btn level-btn" data-level="primary">
                        <span class="icon">ğŸ“˜</span>
                        <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</span>
                    </button>
                    <button class="menu-btn level-btn" data-level="prep">
                        <span class="icon">ğŸ“—</span>
                        <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ©</span>
                    </button>
                    <button class="menu-btn level-btn" data-level="secondary">
                        <span class="icon">ğŸ“•</span>
                        <span>Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©</span>
                    </button>
                    <button class="menu-btn level-btn" data-level="teachers">
                        <span class="icon">ğŸ‘¨â€ğŸ«</span>
                        <span>Ø§Ù„Ù…Ø­ÙØ¸ÙˆÙ†</span>
                    </button>
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
            <div class="table-section" id="tableSection">
                <div class="table-header">
                    <div class="table-header-title">
                        <h2 id="tableTitle">Ø§Ø®ØªØ± Ù…Ø±Ø­Ù„Ø© Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ Ø£Ùˆ Ø§Ù„Ù…Ø­ÙØ¸ÙŠÙ†</h2>
                        <span id="tableSubtitle">
                            Ù„Ø§ ÙŠØªÙ… Ø­ÙØ¸ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©ØŒ ÙÙ‚Ø· Ù‚Ø±Ø§Ø¡Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Google Sheets.
                        </span>
                    </div>

                    <div class="table-header-actions">
                        <input id="searchInput" class="search-input" type="text" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ø­Ù„Ù‚Ø©..." />
                        <span id="statusPill" class="status-pill">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹</span>
                        <button id="reloadBtn" class="ghost-small">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-scroll">
                        <table id="studentsTable">
                            <thead>
                                <tr id="tableHeaderRow"></tr>
                            </thead>
                            <tbody id="tableBody">
                                <tr>
                                    <td colspan="10" class="muted-text">
                                        Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù…Ø±Ø­Ù„Ø© Ø¨Ø¹Ø¯.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div id="loadingOverlay" class="loading-overlay hidden">
                        <div class="spinner"></div>
                        <div class="muted-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets...</div>
                    </div>
                </div>
            </div>

        </div>
    </section>
</div>

<script>
    /******************************
     *  Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
     ******************************/

    const SPREADSHEET_ID = "14bW4VEbCGTOq55aYXiti6xZUPRkwMax7iC7NiynOjb4";

    // Ø§Ù„Ø´ÙŠØªØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙØ¹Ù„ÙŠØ§Ù‹
    const SHEETS_CONFIG = {
        primary: {
            sheetName: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©",
            title: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©"
        },
        prep: {
            sheetName: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ©",
            title: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ©"
        },
        secondary: {
            sheetName: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©",
            title: "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©"
        },
        teachers: {
            sheetName: "Ø§Ù„Ù…Ø­ÙØ¸ÙŠÙ†",
            title: "Ø§Ù„Ù…Ø­ÙØ¸ÙˆÙ†"
        }
    };

    // Ù…Ø¯Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ù„ÙƒÙ„ Ù‚Ø³Ù… (0 = Ø§Ù„Ø¹Ù…ÙˆØ¯ A, 1 = B, 2 = C, ...)
    const COLUMN_RANGES = {
        primary:   { start: 2, end: 10 }, // C â†’ L
        prep:      { start: 2, end: 10 }, // C â†’ L
        secondary: { start: 2, end: 10 }, // C â†’ L
        teachers:  { start: 0, end: 10 }  // A â†’ L
    };

    /******************************
     *        Ø¹Ù†Ø§ØµØ± DOM
     ******************************/

    const splashEl = document.getElementById("splash");
    const mainEl = document.getElementById("main");
    const startBtn = document.getElementById("startBtn");
    const backToSplashBtn = document.getElementById("backToSplashBtn");
    const levelButtons = document.querySelectorAll(".level-btn");
    const tableTitleEl = document.getElementById("tableTitle");
    const tableSubtitleEl = document.getElementById("tableSubtitle");
    const tableHeaderRowEl = document.getElementById("tableHeaderRow");
    const tableBodyEl = document.getElementById("tableBody");
    const loadingOverlayEl = document.getElementById("loadingOverlay");
    const reloadBtn = document.getElementById("reloadBtn");
    const statusPillEl = document.getElementById("statusPill");
    const searchInputEl = document.getElementById("searchInput");

    let currentLevelKey = null;
    let currentAllRows = null;

    /******************************
     *       ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
     ******************************/

    function showSplash() {
        splashEl.classList.remove("hidden");
        mainEl.classList.add("hidden");
    }

    function showMain() {
        splashEl.classList.add("hidden");
        mainEl.classList.remove("hidden");
    }

    function setLoadingState(isLoading, text) {
        if (isLoading) {
            loadingOverlayEl.classList.remove("hidden");
            statusPillEl.classList.add("ok");
            statusPillEl.textContent = text || "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
        } else {
            loadingOverlayEl.classList.add("hidden");
            statusPillEl.classList.remove("ok");
            statusPillEl.textContent = text || "Ø¬Ø§Ù‡Ø²";
        }
    }

    function setErrorState(message) {
        loadingOverlayEl.classList.add("hidden");
        statusPillEl.classList.remove("ok");
        statusPillEl.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„";

        tableHeaderRowEl.innerHTML = "";
        tableBodyEl.innerHTML =
            `<tr><td colspan="10" class="error-msg">${message}</td></tr>`;
    }

    function buildCsvUrl(sheetName) {
        const cacheBuster = Date.now(); // Ø±Ù‚Ù… ÙŠØªØºÙŠØ± ÙƒÙ„ Ù…Ø±Ø©
        return `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(sheetName)}&cb=${cacheBuster}`;
    }

    function parseCsv(csvText) {
        const rows = [];
        const lines = csvText.split(/\r?\n/).filter(l => l.trim().length > 0);

        for (const line of lines) {
            const cells = line.split(",").map(c => c.trim());
            rows.push(cells);
        }
        return rows;
    }

    function getVisibleColumnIndexes(headerRow, levelKey) {
        const range = COLUMN_RANGES[levelKey];

        let indexes = [];
        if (range) {
            const start = Math.max(0, range.start);
            const end = Math.min(headerRow.length - 1, range.end);
            for (let i = start; i <= end; i++) {
                indexes.push(i);
            }
        } else {
            indexes = headerRow.map((_, i) => i);
        }

        if (indexes.length === 0) {
            indexes = headerRow.map((_, i) => i);
        }

        return indexes;
    }

    // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ Ø§Ù„Ù‚Ø§Ø¯Ù… Ù…Ù† Ø§Ù„Ù€ CSV
    function normalizeCell(value) {
        if (value === undefined || value === null) return "";

        let v = value.toString().trim();

        // Ù„Ùˆ Ø§Ù„Ø®Ù„ÙŠØ© Ø¹Ø¨Ø§Ø±Ø© Ø¹Ù† Ø¹Ù„Ø§Ù…Ø§Øª ØªÙ†ØµÙŠØµ ÙÙ‚Ø· (Ø£ÙŠ Ø¹Ø¯Ø¯) Ù†Ø¹ØªØ¨Ø±Ù‡Ø§ ÙØ§Ø¶ÙŠØ©
        const noQuotes = v.replace(/"/g, "");
        if (noQuotes.length === 0) {
            return "";
        }

        // Ø¥Ø²Ø§Ù„Ø© Ø¹Ù„Ø§Ù…Ø§Øª ØªÙ†ØµÙŠØµ Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ© Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©
        while (v.startsWith('"') && v.endsWith('"') && v.length >= 2) {
            v = v.slice(1, -1).trim();
        }

        // Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙØŒ Ù„Ùˆ Ù…Ø§ Ø¨Ù‚Ù‰ Ø¥Ù„Ø§ Ø¹Ù„Ø§Ù…Ø§Øª ØªÙ†ØµÙŠØµ â†’ ÙØ§Ø¶ÙŠØ©
        if (v.replace(/"/g, "").length === 0) {
            return "";
        }

        return v;
    }

    function renderTable(rows, filterTerm = "") {
        if (!rows || rows.length === 0) {
            tableHeaderRowEl.innerHTML = "";
            tableBodyEl.innerHTML =
                `<tr><td colspan="10" class="muted-text">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶.</td></tr>`;
            return;
        }

        const headerRow = rows[0];
        const dataRows  = rows.slice(1);

        const columnIndexes = getVisibleColumnIndexes(headerRow, currentLevelKey);

        // Ø§Ù„Ù‡ÙŠØ¯Ø±
        tableHeaderRowEl.innerHTML = "";
        columnIndexes.forEach((colIndex, visibleIndex) => {
            const th = document.createElement("th");
            const headerText = normalizeCell(headerRow[colIndex]) || `Ø¹Ù…ÙˆØ¯ ${visibleIndex + 1}`;
            th.textContent = headerText;
            tableHeaderRowEl.appendChild(th);
        });

        // Ø§Ù„Ø¬Ø³Ù…
        tableBodyEl.innerHTML = "";

        if (dataRows.length === 0) {
            tableBodyEl.innerHTML =
                `<tr><td colspan="${columnIndexes.length}" class="muted-text">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ø¨Ø¹Ø¯.</td></tr>`;
            tableSubtitleEl.textContent = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.";
            return;
        }

        const normalizedFilter = (filterTerm || "").trim().toLowerCase();

        const filteredRows = normalizedFilter
            ? dataRows.filter(row =>
                row.some(cell =>
                    normalizeCell(cell).toLowerCase().includes(normalizedFilter)
                )
            )
            : dataRows;

        if (filteredRows.length === 0) {
            tableBodyEl.innerHTML =
                `<tr><td colspan="${columnIndexes.length}" class="muted-text">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ø¨Ø­Ø«Ùƒ.</td></tr>`;
        } else {
            filteredRows.forEach(row => {
                const rowEl = document.createElement("tr");

                columnIndexes.forEach(colIndex => {
                    const td = document.createElement("td");
                    td.textContent = normalizeCell(row[colIndex]);
                    rowEl.appendChild(td);
                });

                tableBodyEl.appendChild(rowEl);
            });
        }

        if (normalizedFilter) {
            tableSubtitleEl.textContent =
                `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: ${filteredRows.length} Ù…Ù† ${dataRows.length} (Ø¨Ø¹Ø¯ Ø§Ù„ØªØµÙÙŠØ©)`;
        } else {
            tableSubtitleEl.textContent =
                `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: ${dataRows.length}`;
        }
    }

    async function loadLevel(levelKey) {
        const config = SHEETS_CONFIG[levelKey];
        if (!config || !config.sheetName || !SPREADSHEET_ID) {
            setErrorState("ØªØ£ÙƒØ¯ Ù…Ù† Ø¶Ø¨Ø· SPREADSHEET_ID ÙˆØ§Ø³Ù… Ø§Ù„Ø´ÙŠØª Ù„ÙƒÙ„ Ù…Ø±Ø­Ù„Ø© ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.");
            return;
        }

        currentLevelKey = levelKey;
        currentAllRows = null;
        searchInputEl.value = "";

        tableTitleEl.textContent = `Ø¨ÙŠØ§Ù†Ø§Øª ${config.title}`;
        tableSubtitleEl.textContent = "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª...";

        levelButtons.forEach(btn => {
            if (btn.dataset.level === levelKey) {
                btn.classList.add("active");
            } else {
                btn.classList.remove("active");
            }
        });

        setLoadingState(true, "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª " + config.title + "...");

        try {
            const url = buildCsvUrl(config.sheetName);
            const response = await fetch(url);

            if (!response.ok) {
                throw new Error(
                    "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Google SheetsØŒ ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø´ÙŠØª Ù…Ù†Ø´ÙˆØ± Ù„Ù„Ø¹Ø§Ù…Ø© (Share / Publish to web)."
                );
            }

            const csvText = await response.text();
            const rows = parseCsv(csvText);
            currentAllRows = rows;

            renderTable(currentAllRows);
            setLoadingState(false, "ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­");

        } catch (err) {
            console.error(err);
            setErrorState("ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: " + err.message);
        }
    }

    /******************************
     *       Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
     ******************************/

    startBtn.addEventListener("click", () => {
        showMain();
    });

    backToSplashBtn.addEventListener("click", () => {
        showSplash();
    });

    levelButtons.forEach(btn => {
        btn.addEventListener("click", () => {
            const levelKey = btn.dataset.level;
            loadLevel(levelKey);
        });
    });

    reloadBtn.addEventListener("click", () => {
        if (currentLevelKey) {
            loadLevel(currentLevelKey);
        } else {
            tableSubtitleEl.textContent = "Ø§Ø®ØªØ± Ù…Ø±Ø­Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ø¶ØºØ· ØªØ­Ø¯ÙŠØ«.";
        }
    });

    searchInputEl.addEventListener("input", () => {
        if (!currentAllRows) return;
        const term = searchInputEl.value;
        renderTable(currentAllRows, term);
    });
</script>
</body>
</html>

